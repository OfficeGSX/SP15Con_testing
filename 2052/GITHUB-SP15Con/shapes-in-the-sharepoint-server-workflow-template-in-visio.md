---
title: Visio 中的 SharePoint Server 工作流模板中的形状
ms.prod: SHAREPOINT
ms.assetid: f35bdf5d-c102-4e2d-8a23-1d2df17155b9
---



# Visio 中的 SharePoint Server 工作流模板中的形状
了解 Visio 2013 中的 SharePoint 2013 工作流模板中的形状。
## 简介
<a name="VSSPD_Shapes_Intro"> </a>

本文列出了 Visio 2013 中的 SharePoint 2013 工作模板中包含的形状，以及 SharePoint Designer 2013 中的可视化设计器中的形状。当模板打开时， 会打开 SharePoint 2013 工作流操作、SharePoint 2013 工作流条件以及 SharePoint 2013 工作流终止符模具。在模具中列出的很多形状对应于特定行为、条件或者是 Declarative Designer 中的其他逻辑结构，其中 Declarative Designer 用以在 SharePoint Designer 2013 中创建工作流。
  
    
    

> **重要信息**
> 以下是 SharePoint Designer 2013 支持的工作流操作的一个引用。尽管其中一个（等待列表项目事件）操作在目前的版本中已得到改进和增强，但这些操作中的大部分在 SharePoint Designer 2010 中仍可用。在目前的版本中，删除了 25 个操作，同时引入了 12 个新的操作。（若要查看被删除的操作、条件和模块的列表，请参阅 [可使用工作流互操作性桥执行的工作流操作](workflow-actions-available-using-the-workflow-interop-bridge.md)。） 
  
    
    


## 操作形状
<a name="VSSDP_Actions"> </a>

下表显示了 Visio 2013SharePoint 2013 工作流模板的 SharePoint 2013 操作模具中包含的所有形状的列表。
  
    
    

> **注释**
> 下表列出的每个形状将列出属性和"属性"属性。 
  
    
    



|**Visio 2013 和 SharePoint Designer 2013 可视化设计器中的形状。**|**SharePoint Designer 2013 Declarative Designer 中的操作**|**SharePoint Designer 2013 可视化设计器中的属性**|**说明**|
|:-----|:-----|:-----|:-----|
|添加注释  <br/> |"添加注释"  <br/> |"注释"  <br/> |使您能够在工作流设计器中留下相关评论以供参考。当有其他用户对工作流进行协作时，这将非常有用。  <br/> |
|将时间添加到日期  <br/> |"将时间添加到日期"  <br/> | "月" <br/>  "天" <br/>  "小时" <br/>  "分钟" <br/>  "日期" <br/>  "输出" <br/> |将一个特定的时间以分钟、小时、天或月的格式添加到一个日期，并将输出值保存为一个变量。日期可以是当前数据、特定的日期或查找。"当前日期"值返回 UTC 午夜时间。  <br/> |
|分配任务  <br/> |"分配任务"  <br/> | "任务设置" <br/>  "任务结果" <br/>  "任务项 ID" <br/> |将工作流任务分配给用户，并建立完成任务的截止日期。  <br/> |
|调用 HTTP Web 服务  <br/> |"调用 HTTP Web 服务"  <br/> | "HTTP 请求" <br/>  "参数" <br/>  "响应内容变量" <br/>  "响应标头变量" <br/>  "响应代码变量" <br/> |作为对 HTTP Web 服务的一个方法调用。  <br/> > **注释**> 当前版本只支持对"匿名"HTTP 服务的 SharePoint 调用且只使用 **string** 参数和返回类型。此外，我们不支持复合 XML 元素。还请注意，我们目前仅支持经典 ASMX，不支持 WCG 服务。          |
|签入项目  <br/> |"签入项目"  <br/> | "项目" <br/>  "注释" <br/> |签入已签出的项。您只能从一个文档库中签入项目。  <br/> > **警告**> 当您试图签入一个未签出的项目时，工作流就会崩溃。           |
|签出项目  <br/> |"签出项目"  <br/> |"项目"  <br/> |签出一个项目。工作流验证该项目签入之前是否已从文档中签出。您只能从自己的网站的库中签出项目。  <br/> > **警告**> 当您试图签出一个未签入的项目时，工作流会出错。           |
|复制文档  <br/> |"复制文档"  <br/> | "文档" <br/>  "库" <br/> |将文档从当前列表复制到一个不同的文档库列表。  <br/> |
|字典中的计数项  <br/> |"词典中的计数项目"  <br/> | "词典" <br/>  "输出变量" <br/> |计算字典变量中的项目数。  <br/> |
|从当前项创建项目  <br/> |"从当前项创建项目"  <br/> |"企业项目类型"  <br/> |获取当前项目并在 SharePoint 场 PWA 网站中创建一个新项目。  <br/> |
|创建列表项  <br/> |"创建列表项"  <br/> | "项目" <br/>  "输出变量" <br/> |在您指定的列表中创建新的列表项。您可以提供新项目中的域和值。每当要用特定的信息创建新项目时，您都可以使用此操作。  <br/> |
|删除项目  <br/> |"删除项目"  <br/> |"项目"  <br/> |删除一个项目。  <br/> > **注释**> 在运行 Workflow Manager 工作流引擎的计算机上，该操作将会被终止，并会引发一个 **System.InvalidOperationException** 异常。没有解决办法。          |
|放弃签出  <br/> |"放弃签出项目"  <br/> |"项目"  <br/> |当项目被签出并对其做了更改时，放弃更改并将其签回来。  <br/> > **警告**> 当您试图签入一个未签出的项目时，工作流就会崩溃。           |
|进行计算  <br/> |"进行计算"  <br/> | "左操作数" <br/>  "运算符" <br/>  "右操作数" <br/>  "自" <br/> |执行算术计算，并将输出的值存储在一个变量中。  <br/> > **注释**> 对于 SharePoint 2013 来说，此操作仅支持 **Double** 数值类型，不支持整数，不支持使用"+"运算符（串联）的字符串。          |
|从字符串结尾提取子字符串  <br/> |"从字符串结尾提取子字符串"  <br/> | "字符数" <br/>  "字符串" <br/>  "输出" <br/> |复制指定的数目的字符（从字符串的末尾开始），并将输出存储在变量中。  <br/> |
|从字符串索引提取子字符串  <br/> |"从字符串索引提取子字符串"  <br/> | "字符串" <br/>  "索引" <br/>  "输出" <br/> |复制一个从字符串中的指定索引处开始的子字符串，并将该值放在一个变量中。  <br/> > **注释**> 请注意，虽然目前的 SharePoint Designer 技术预览版中的索引值是从零开始的，但是在 SharePoint Designer 2010 中索引值是从 1 开始的。           |
|从字符串开头提取子字符串  <br/> |"从字符串开头提取子字符串"  <br/> | "字符数" <br/>  "字符串" <br/>  "输出" <br/> |复制从字符串的开头开始的指定数目的字符，并将输出存储在一个变量中。  <br/> |
|从长度索引提取字符串的子字符串  <br/> |"从长度索引提取字符串的子字符串"  <br/> | "字符串" <br/>  "索引" <br/>  "字符数" <br/>  "输出" <br/> |复制从字符串指定索引处开始并包括指定数量字符的子字符串，并将该值放在一个变量中。  <br/> > **注释**> 请注意，虽然目前的 SharePoint Designer 技术预览版中的索引值是从零开始的，但是在 SharePoint Designer 2010 中索引值是从 1 开始的。           |
|查找日期之间的间隔  <br/> |"查找日期之间的间隔"  <br/> | "单位" <br/>  "开始日期" <br/>  "结束日期" <br/>  "输出" <br/> |以分钟、小时或天计算两个日期之间的时间间隔，并将输出存储在一个变量中。  <br/> |
|在字符串中查找子字符串  <br/> |"在字符串中查找子字符串"  <br/> | "子字符串" <br/>  "字符串" <br/>  "输出" <br/> |查找一个字符串内的特定子字符串，并返回子字符串起始位置的索引。  <br/> |
|从字典中获取项目  <br/> |"从字典中获取项目"  <br/> | "路径的项目名称" <br/>  "词典" <br/>  "输出变量" <br/> |从词典变量返回一个特定项。  <br/> |
|记录到历史记录列表  <br/> |"记录到历史记录列表"  <br/> |"消息"  <br/> |将预定义的消息项目列表中的消息写入到工作流历史记录列表中。  <br/> |
|暂停持续时间  <br/> |"暂停持续时间"  <br/> | "天" <br/>  "小时" <br/>  "分钟" <br/> |导致工作流暂停执行指定的时间间隔（以天、小时和分钟这种格式表示）。  <br/> |
|暂停到某个日期  <br/> |"暂停到某个日期"  <br/> |"日期"  <br/> |导致工作流暂停执行，直到指定的日期和时间。  <br/> |
|替换字符串中的子字符串  <br/> |"替换字符串中的子字符串"  <br/> | "搜索字符串" <br/>  "替换字符串" <br/>  "字符串" <br/>  "输出" <br/> |将特定子字符串替换为另一个子字符串。  <br/> |
|发送电子邮件  <br/> |"发送电子邮件"  <br/> |"电子邮件"  <br/> |当发生指定的工作流事件时，会给用户或组自动发送一封电子邮件，其中包含预先确定的消息。  <br/> > **重要信息**> 如果该网站未添加到受信任的网站列表中，电子邮件会发送到 Outlook 垃圾文件夹中。           |
|设置当前项目中的域  <br/> |"设置当前项目中的域"  <br/> | "域" <br/>  "值" <br/> |将当前项目中的域设置为一个值。  <br/> |
|设置日期/时间域的时间部分  <br/> |"设置日期/时间域的时间部分"  <br/> | "小时" <br/>  "分钟" <br/>  "日期" <br/>  "输出" <br/> |创建一个时间戳，并将输出值存储在一个变量中。您可以以小时和分钟设置时间，并添加当前日期、特定日期或查找。  <br/> |
|设置工作流状态  <br/> |"设置工作流状态"  <br/> |"状态"  <br/> |设置工作流的状态。  <br/> |
|设置工作流变量  <br/> |"设置工作流变量"  <br/> | "变量" <br/>  "值" <br/> |将工作流变量设置为一个值。当您希望工作流将数据分配给一个变量时，也可以使用此操作。  <br/> |
|启动列表工作流  <br/> |"启动列表工作流"  <br/> | "关联名称" <br/>  "输入" <br/>  "项目" <br/> |启动 SharePoint 2010 列表工作流。  <br/> > **注释**>  "启动列表工作流"具有下列问题：>  当 2010 工作流中有 TaskProcess 操作时，"任务"类型域不能用作参数。>  当对同一 2010 工作流进行多次调用时，2013 工作流查找功能中会有多个数据源。这些数据源都是一样的。>  2013 的变量名中不能包含"?"和"#"之类的特殊字符。如果 2010 工作流中包含特殊字符，在 2013 工作流中它们将被转换为十六进制代码。          |
|启动网站工作流  <br/> |"启动网站工作流"  <br/> | "关联名称" <br/>  "参数" <br/> |启动一个 SharePoint 2010 网站工作流。  <br/> > **注释**>  "启动列表工作流"具有下列问题：>  当 2010 工作流中有 TaskProcess 操作时，"任务"类型域不能用作参数。>  当对同一 2010 工作流进行多次调用时，2013 工作流查找功能中会有多个数据源。这些数据源都是一样的。>  2013 的变量名中不能包含"?"和"#"之类的特殊字符。如果 2010 工作流中包含特殊字符，在 2013 工作流中它们将被转换为十六进制代码。          |
|启动任务进程  <br/> |"启动任务进程"  <br/> | "进程设置" <br/>  "进程结果" <br/> |创建多用户任务，并使该任务能够通过自定义进程执行。  <br/> |
|翻译文档  <br/> |"翻译文档"  <br/> | "文档" <br/>  "语言" <br/>  "文档库" <br/> |将文档翻译为一种特定语言。  <br/> > **注释**> 需要一个预配置的机器翻译服务应用程序。           |
|剪裁字符串  <br/> |"剪裁字符串"  <br/> | "字符串" <br/>  "输出" <br/> |删除从字符串开始到结束的空格。  <br/> |
|更新列表项  <br/> |"更新列表项"  <br/> |"项目"  <br/> |更新列表项。您可以指定域以及这些域中的新值。  <br/> |
|等待列表项中的事件  <br/> |"等待列表项中的事件"  <br/> | "事件" <br/>  "相关项目" <br/> |[增强版的 Office 2010 操作]。暂停工作流的当前实例，以等待指定的列表项事件。此操作监听两个事件： **ItemUpdated** 和 **ItemAdded**。  <br/> |
|等待域更改  <br/> |"等待域更改"  <br/> | "域" <br/>  "值" <br/> |等待当前项的一个域上等于某个特定值。  <br/> |
|设置项目域  <br/> |"设置项目域"  <br/> | "域" <br/>  "值" <br/> |设置 Project Server 上某特定域的值。  <br/> > **注释**> 此操作要求先签入项目。如果项目未被签入，该工作流将被终止，用户无法打开该项目中 Project Web App。           |
|设置项目阶段状态  <br/> |"设置项目阶段状态"  <br/> | "阶段状态" <br/>  "阶段信息" <br/> |设置项目阶段的状态。  <br/> > **注释**> 选中一个当前项目时发生异常。           |
|设置构思列表中的状态域  <br/> |"设置构思列表中的状态域"  <br/> |"状态"  <br/> |更新关联到当前项目的原始列表项的状态。  <br/> |
|等待项目事件  <br/> |"等待项目事件"  <br/> |"事件名称"  <br/> |等待特定项目事件。  <br/> |
   

## 条件形状
<a name="VSSPD_Conditions"> </a>

下表显示了 SharePoint 2013 工作流模板的 SharePoint 2013 条件模具中包含的所有形状的列表。
  
    
    


|**Visio 2013 和 SharePoint Designer 2013 可视化设计器中的形状。**|**SharePoint Designer 2013 Declarative Designer 中的操作**|**SharePoint Designer 2013 可视化设计器中的属性**|**说明**|
|:-----|:-----|:-----|:-----|
|如果任何值等于值  <br/> |"如果任何值等于值"  <br/> | "值" <br/>  "操作数" <br/>  "值" <br/> |比较两个值。您可以指定这两个值是否相等。  <br/> |
|人员是有效的 SharePoint 用户  <br/> |"人员是有效的 SharePoint 用户"  <br/> |"用户"  <br/> |查看特定用户是否为已注册用户或是 SharePoint 网站上的组的成员。  <br/> |
|跳过项目阶段  <br/> |"跳过项目阶段"  <br/> |NA  <br/> |此条件查看在当前工作流实例的服务器上，到阶段功能的跳跃是否已激活。  <br/> |
   

## 终止符形状
<a name="VSSPD_Terminators"> </a>

下表显示了 SharePoint 2013 工作流模板的 SharePoint 2013 终止符模具中包含的所有形状的列表。
  
    
    


|**Visio 2013 和 SharePoint Designer 2013 可视化设计器中的形状。**|**SharePoint Designer 2013 Declarative Designer 中的操作**|**SharePoint Designer 2013 可视化设计器中的属性**|**说明**|
|:-----|:-----|:-----|:-----|
|启动  <br/> |NA  <br/> |NA  <br/> |开启工作流。每个 SharePoint 2013 工作流关系图只能有一个启动形状。  <br/> |
|阶段  <br/> |"阶段"  <br/> |NA  <br/> |包含任意数目的形状，并可能包括分支。每个阶段都必须包含工作流中的所有操作。阶段形状要求在容器的边缘添加一个进入和退出形状，来定义进入和退出该阶段的路径。  <br/> 有关详细信息，请参阅文章 [SharePoint Designer 和 Visio 中的工作流开发](workflow-development-in-sharepoint-designer-and-visio.md) 中的"阶段、循环和步骤"一节。 <br/> |
|步骤  <br/> |"步骤"  <br/> |NA  <br/> |表示顺序操作的分组系列。每个阶段都必须包含这些步骤。步骤形状还必须有进入和退出形状，这两个形状是在步骤形状被放置到画布上时添加的。  <br/> 有关详细信息，请参阅文章 [SharePoint Designer 和 Visio 中的工作流开发](workflow-development-in-sharepoint-designer-and-visio.md) 中的"阶段、循环和步骤"一节。 <br/> |
|简单阶段  <br/> |"阶段"  <br/> |NA  <br/> |在 Visio 2013 的阶段视图中，将新的阶段添加到工作流的顶层。  <br/> |
|循环 n 次  <br/> |"循环 n 次"  <br/> |"循环计数"  <br/> |定义一个已连接的形状序列，该循环从序列中的最后一个形状返回到第一个形状，重复执行，直到该循环执行了指定次数。像阶段一样，循环由一个具有进入、退出形状的容器形状表示。  <br/> 有关详细信息，请参阅文章 [SharePoint Designer 和 Visio 中的工作流开发](workflow-development-in-sharepoint-designer-and-visio.md) 中的"阶段、循环和步骤"一节。 <br/> |
|条件循环  <br/> |"条件循环"  <br/> |"循环计数"  <br/> |在满足特定条件之前执行循环。  <br/> |
|启动并行操作  <br/> |"并行块"  <br/> |NA  <br/> ||
|结束并行操作  <br/> |"并行块"  <br/> |NA  <br/> ||
   

## 其他资源
<a name="VSSPD_Additional"> </a>


-  [SharePoint Designer 和 Visio 中的工作流开发](workflow-development-in-sharepoint-designer-and-visio.md)
    
  
-  [工作流操作快速参考（SharePoint 2013 工作流平台）](workflow-actions-quick-reference-sharepoint-2013-workflow-platform.md)
    
  
-  [SharePoint 工作流模板形状指南](http://office.microsoft.com/en-us/HA101903894.aspx)
    
  
-  [SharePoint 开发中心](http://msdn.microsoft.com/zh-cn/sharepoint/default.aspx)
    
  
-  [Visio 开发中心](http://msdn.microsoft.com/zh-cn/office/aa905478)
    
  
