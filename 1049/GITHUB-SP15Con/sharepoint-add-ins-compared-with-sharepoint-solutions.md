---
title: Сравнение надстроек SharePoint с решениями SharePoint
ms.prod: SHAREPOINT
ms.assetid: 0e9efadb-aaf2-4c0d-afd5-d6cf25c4e7a8
---


# Сравнение надстроек SharePoint с решениями SharePoint
Узнайте, когда стоит разрабатывать расширение SharePoint 2013 как Надстройка SharePoint, а когда  как решение фермы для SharePoint или изолированные решения без кода.
 * **Область применения:*** 
  
    
    

В этой статье сравниваются варианты использования Надстройки SharePoint, решения ферм и изолированные решения без кода (решения NCSS).
- Новые Надстройки SharePoint  это автономные расширения, которые могут включать облачную логику и данные, компоненты SharePoint и клиентские сценарии, но не могут содержать пользовательский управляемый код, который запускается на сервере SharePoint. Они устанавливаются либо из магазина Магазин Office, либо из каталога надстроек организации и могут быть установлены либо в локальных фермах, либо на портале Microsoft SharePoint Online. Обзор Надстройки SharePoint см. в статье  [Надстройки SharePoint](http://msdn.microsoft.com/library/cd1eda9e-8e54-4223-93a9-a6ea0d18df70%28Office.15%29.aspx).
    
  
- решения фермSharePoint  это пакеты компонентов SharePoint, загружаемые в коллекцию на уровне фермы, откуда их можно установить. Они не распространяются через Магазин Office и не устанавливаются на портале SharePoint Online. Они могут включать пользовательский управляемый код, который запускается на серверах фермы SharePoint. Дополнительные сведения об основах решения ферм см. в статьях  [Обзор решений](http://msdn.microsoft.com/library/1983cab9-4b29-494a-a62a-0f8e83908744%28Office.15%29.aspx) и [Решения для фермы](http://msdn.microsoft.com/library/845f7524-b9ff-412b-aa29-3afacda91100%28Office.15%29.aspx).
    
  
- Решения NCSS также являются пакетами компонентов SharePoint, но они загружаются в коллекцию семейства веб-сайтов, из которой их можно установить. Их можно устанавливать либо в локальных фермах, либо в SharePoint Online, но они не распространяются через Магазин Office. Они могут включать почти такие же типы описательных компонентов, как Надстройки SharePoint, и, как и надстройки, могут содержать JavaScript. Тем не менее в них отсутствует пользовательский управляемый код, который запускается на серверах SharePoint. Учитывая различия между системами развертывания решений NCSS и надстроек, первые предпочтительны лишь в небольшом списке сценариев. Сведения о изолированные решения см. в статье  [Изолированные решения в SharePoint 2010](https://technet.microsoft.com/ru-ru/library/ee721992%28v=office.14%29.aspx).
    
  

> **Важно!**
> Если вы разрабатываете изолированные решения, который содержит только декларативную разметку и допускает использование JavaScript, то есть изолированных решений без кода (NCSS), не стоит применять пользовательский управляемый код в изолированные решения. Мы представили новую модель надстроек SharePoint как замену для тех сценариев, в которых необходимо использовать управляемый код. Эта модель надстроек отделяет основной продукт SharePoint от среды выполнения надстройки, и это увеличивает гибкость и позволяет запускать код в среде на выбор. Мы понимаем, что наши клиенты внесли инвестиции в кодированные изолированные решения, и мы ответственно подойдем к их поэтапному свертыванию. В обозримом будущем существующие кодированные изолированные решения будут продолжать функционировать в локальных фермах SharePoint. Учитывая динамический характер онлайн-служб, мы будем определять потребности в поддержке для кодированных изолированные решения в SharePoint Online, основываясь на потребительском спросе. Решения NCSS будут и дальше поддерживаться. Все будущие инвестиции будут использованы для расширения возможностей и увеличения эффективности новой модели SharePoint. Соответственно, мы рекомендуем использовать ее для всех новых разработок, где это возможно. В случае решение фермы или закодированного решения изолированные решения стоит выбрать сценарий, который позволит с легкость вносить изменения в модель разработки. 
  
    
    


## Есть возможность? Разрабатывайте надстройки
<a name="AppWhenYouCan"> </a>

Вот наш самый важный совет: если только возможно, разрабатывайте Надстройка SharePoint вместо решение фермы или решения NCSS. Ниже указаны преимущества Надстройки SharePoint над классическими решениями.
  
    
    

- Простота процесса обнаружения, покупки и установки для пользователей.
    
  
- Наиболее безопасные расширения SharePoint для администраторов.
    
  
- Простая система маркетинга и продаж на базе интернет-магазина надстроек Майкрософт.
    
  
- Максимальная гибкость в разработке будущих обновлений.
    
  
- Максимальные возможности для использования навыков программирования, не относящихся к SharePoint.
    
  
- Более плавные и гибкие способы интеграции облачных ресурсов.
    
  
- Предоставление расширению разрешений, которые отличаются от разрешений пользователя, запустившего надстройку.
    
  
- Возможность использовать кроссплатформенные стандарты, включая HTML, REST, OData, JavaScript и OAuth.
    
  
- Возможность пользоваться междоменной библиотекой сценариев JavaScriptSharePoint для доступа к данным SharePoint. Кроме того, можно использовать предоставленную корпорацией Майкрософт безопасную службу маркеров, совместимую с OAuth, или цифровые сертификаты, чтобы получить авторизацию для доступа к данным SharePoint.
    
  

## Разработка надстроек или решений NCSS для конечных пользователей и разработка решений фермы для администраторов
<a name="SPAppVsClassic_Overview"> </a>

Надстройки SharePoint и решения NCSS используют одну из клиентских объектных моделей SharePoint или конечные узлы REST для доступа к содержимому и компонентам SharePoint. Эти клиентские интерфейсы включают расширения SharePoint, разработанные для конечных пользователей. (В этом контексте под "конечными пользователями" подразумеваются администраторы семейств веб-сайтов, владельцы и посетители веб-сайтов.) Объектная модель сервера имеет дополнительные интерфейсы, которые включают программные расширения для управления, конфигурации и безопасности SharePoint. Сюда входят расширения центра администрирования, настраиваемые команды Windows PowerShell, задания таймера и настраиваемые архивы. Более подробную информацию о типах административных расширений, которые можно разрабатывать, см. в статье  [Администрирование Windows SharePoint Services](http://msdn.microsoft.com/library/cdcc1b8a-4144-446f-b471-03d4a754a8ab%28Office.15%29.aspx). Эти административные расширения развертываются в компонентах SharePoint в масштабах фермы, веб-приложения или семейства сайтов. решения фермSharePoint также устанавливаются администраторами ферм, хотя надстройки и решения NCSS могут быть установлены владельцем и администраторами семейства сайтов.
  
    
    
Объектная модель сервера также имеет API для действий создания, чтения, обновления и удаления (CRUD) над списками, библиотеками и веб-сайтами, а также для действий над другими компонентами SharePoint. Это означает, что объектная модель сервера может быть использована для расширений, предназначенных для конечных пользователей, но по причинам, приведенным в предыдущем разделе, решения ферм не всегда лучший выбор для таких расширений. Поэтому неудивительно, что решения ферм не устанавливаются в Microsoft SharePoint Online. Корпорация Майкрософт полностью управляет SharePoint Online, поэтому в административных расширениях нет необходимости. Более подробную информацию о наборах API в SharePoint, а также об их наложениях см. в разделе  [Выбор правильного набора API в SharePoint 2013](choose-the-right-api-set-in-sharepoint-2013.md).
  
    
    
Клиентские объектные модели и конечные узлы REST не дублируют ориентированные на администраторов API объектной модели сервера. Более того, в виду того, что ни Надстройка SharePoint, ни решение NCSS не может содержать пользовательский код, который запускается на серверах SharePoint, их будет неправильно называть API администратора. К тому же, все компоненты Надстройки SharePoint должны быть в масштабе веб-сайтов, а компоненты решений NCSS  в масштабе веб-сайтов или их семейств. Поэтому расширение SharePoint для администраторов несовместимо с Надстройка SharePoint или решением NCSS. Таким образом, вторым принципом (но не непреложным правилом) является то, что надстройки и решения NCSS предназначены для конечных пользователей, а решения ферм  для администраторов.
  
    
    

## Разработка решений NCSS для расширений с фирменной символикой и шаблонных расширений
<a name="SPAppVsClassic_Overview"> </a>

Вы можете столкнуться с одним из немногих сценариев разработки SharePoint, для которых не очень подходит модель надстроек, но и с помощью решение фермы их не выполнить (возможно, потому что решение нужно устанавливать на SharePoint Online или это должен делать администратор семейства веб-сайтов). Существует две основных перекрывающихся категории таких сценариев.
  
    
    

- **Фирменная символика.** Пользователи SharePoint часто хотят, чтобы у их веб-сайтов SharePoint, включая сайты SharePoint Online, был индивидуальное оформление, собственная цветовая гамма, стиль, структура и логотипы. Обычно это проще сделать с помощью решений NCSS, чем с помощью приложений для Надстройки SharePoint. Надстройка SharePoint имеет декларативный элемент управления только для оформления сайта надстройки. Для хост-сайта с его помощью можно декларативно добавить только кнопки ленты и пункты меню (и веб-части надстроек). Любые другие изменения хост-сайта или его родительского семейства сайтов, владельца или локального веб-приложения SharePoint необходимо выполнять с помощью кода или скрипта, который использует одну из клиентских объектных моделей SharePoint. Например, новые значки или CSS-файлы должны развертываться с помощью программных средств. Этот код можно запустить из самого приложения после установки или в обработчике событий установки надстройки. Но создание такого кода требует значительного объема работы. Более того, этой надстройке необходимы разрешения уровня семейства веб-сайтов, чтобы изменить любые веб-сайты вне его собственного сайта надстройки и хост-сайта, а также требуются разрешения уровня владельца сайта для изменений, выходящих за рамки родительского семейства веб-сайтов. Однако фирменную символику NCSS, которая может состоять из нескольких чисто декларативных компонентов, можно развертывать и активировать в любом семействе веб-сайтов.
    
    > **Примечание**
      > Обратите внимание, что решения решения фермSharePoint потенциально являются более мощными, чем решения NCSS или Надстройки SharePoint для фирменной символики, но они не походят для SharePoint Online. 
- **Шаблонные расширения.** Предположим, вам нужно создать расширение SharePoint для антикризисного управления (совместного анализа и решения критических ситуаций) в бизнесе. Расширение содержит несколько типов настраиваемых списков, рабочие процессы без кода и другие компоненты SharePoint, объединенные в настраиваемый веб-шаблон. Предположим, вы распаковываете и развертываете расширение в виде решения NCSS. После активации компонента решения пользователи могут создать дочерний сайт своего веб-сайта SharePoint для урегулирования кризисных ситуаций при каждом их возникновении. Веб-сайт можно заполнить характерными данными об этом кризисе. С другой стороны, можно внедрить такое же расширение, как Надстройка SharePoint, с помощью того же самого набора компонентов SharePoint. При установке приложения на сайте группы сразу же создается дочерний сайт (или "сайт надстройки"). Опять же, пользователи заполняют веб-сайт соответствующими данными.
    
    Итак, что происходит при возникновении второй кризисной ситуации? Если расширение реализовано как решение NCSS, пользователи могут создать только другой дочерний сайт из настраиваемого веб-шаблона. Тем не менее, если расширение реализовано в виде Надстройка SharePoint, пользователи столкнутся с проблемой. Им не удастся установить второй экземпляр приложения на свой родительский веб-сайт. На хост-сайте можно установить только один экземпляр надстройки. Оптимальным решением будет создание дочернего сайта, который будет служить для размещения другого экземпляра устанавливаемой надстройки. При установке надстройки создается новый сайт для ее компонентов, являющийся дочерним по отношению к дочернему сайту родительского веб-сайта. Это сравнение отображает общий, но не абсолютный принцип: расширения SharePoint, имеющие шаблонный характер, представляют собой многоразовый набор компонентов, которые необходимо настраивать для каждого отдельного варианта использования, но которые сами по себе имеют множество экземпляров, относящихся к одному и тому же веб-сайту SharePoint. Они больше подходят для модели разработки решений NCSS, чем для модели надстроек. В данном примере кризис  это переменный элемент, однако можно легко представить шаблонные расширения SharePoint, в которых экземпляры отличаются по регионам, дате или любому количеству других характеристик.
    
  
Сведения о том, как расширить возможности Надстройки SharePoint, см. в статьях  [Умеренное использование обработчиков событий надстройки](#AppEventHandlers) и [Надстройки, создающие расширения](#ExtensionFactories).
  
    
    

## Как это работает в надстройках
<a name="Questions"> </a>

Как отмечалось ранее, пользовательский код, который запускается на серверах SharePoint, не разрешен в Надстройки SharePoint. Это  *не*  существенное ограничение. Это просто означает, что ваша пользовательская бизнес-логика перемещается либо "вниз" на устройство клиента, либо "вверх" в облако. В любом случае, можно использовать [службу SharePoint REST/OData](http://msdn.microsoft.com/library/f60ed19e-9840-4f39-911e-4676751a2f6b%28Office.15%29.aspx) для доступа к сайтам, спискам и другим данным SharePoint. Кроме того, можно использовать удаленный доступ к данным SharePoint с помощью [клиентских объектных моделей SharePoint JavaScript, Silverlight или .NET Framework](http://msdn.microsoft.com/library/8c086b11-2b8b-41ec-82ae-cd4fef0aeac6%28Office.15%29.aspx). Наконец, на устройствах Windows Phone можно открытьSharePoint с помощью объектной модели Windows PhoneSharePoint. Дополнительные сведения о различных наборах API в SharePoint 2013 см. в разделе  [Выбор правильного набора API в SharePoint 2013](choose-the-right-api-set-in-sharepoint-2013.md).
  
    
    
Схожей чертой является то, что компоненты в Надстройки SharePoint не могут быть в масштабе семейства сайтов, веб-приложения или фермы. Тем не менее, любые элементы пользовательского интерфейса (UI) и функциональные возможности можно реализовать. Это означает, что реализация компонента перемещается из SharePoint на клиент, удаленное веб-приложение или удаленную базу данных.
  
    
    
В следующей таблице перечислены компоненты SharePoint, которые не развертываются в Надстройка SharePoint, и описано, как получить такие же функциональные возможности в надстройках.
  
    
    


|**Необходимые функциональные возможности**|**Подходы**|
|:-----|:-----|
|Настраиваемые веб-части  <br/> |Надстройка SharePoint может иметь удаленные страницы, которые содержат настраиваемые веб-части. Другой вариант  предоставить страницу из удаленного веб-приложения в веб-часть надстройки на странице веб-сайта SharePoint. В целом удаленная страница может иметь те же элементы управления пользовательского интерфейса и функциональные возможности, что и веб-часть. Дополнительные сведения см. в статье  [Создание веб-частей надстройки для установки совместно с надстройкой для SharePoint](http://msdn.microsoft.com/library/a2664289-6c56-4cb1-987a-22367fad55eb%28Office.15%29.aspx).  <br/> |
|Приемники событий и компонентов  <br/> |Надстройка SharePoint может содержать приемники удаленных событий, выполняющие те же функции. Дополнительные сведения см. в статье  [Обработка событий в надстройках SharePoint](http://msdn.microsoft.com/library/c050d056-8548-4496-a053-016779d723d9%28Office.15%29.aspx).  <br/> |
|Типы настраиваемых полей (столбцов)  <br/> |Надстройка может развертывать новое поле (столбец) на основе одного из  [существующих типов полей](http://msdn.microsoft.com/ru-ru/library/microsoft.sharepoint.spfieldtype.aspx%28Office.15%29.aspx). Типы полей  [Calculated](http://msdn.microsoft.com/library/8703373d-bb55-4132-8c5f-37a41c383f81%28Office.15%29.aspx) и [Computed](http://msdn.microsoft.com/ru-ru/library/microsoft.sharepoint.spfieldcomputed.aspx%28Office.15%29.aspx) особенно гибкие. Другой вариант  представление данных на удаленной веб-странице с помощью измененных элементов управления или сеток. <br/> |
|Пользовательские веб-службы, основанные на SharePoint  [Платформа приложений служб](http://msdn.microsoft.com/library/6d0300d2-5b5c-4477-a9e2-17594aea5a7d%28Office.15%29.aspx) <br/> |Вы можете разрабатывать пользовательские веб-службы в виде удаленных служб.  <br/> |
|Страницы приложений  <br/> |Надстройка SharePoint может включать удаленные веб-страницы, которые доступны с любого веб-сайта, на котором установлена надстройка. Надстройка также может использовать любую встроенную веб-часть SharePoint на страницах сайта.  <br/> |
   
Некоторые перечисленные ниже компоненты SharePoint используются в сценариях конечных пользователей, но не имеют аналогов в модели надстройки SharePoint и не развертываются в решениях NCSS. Для этого необходимо использовать решения ферм.
  
    
    

- **Определения пользовательских узлов** Только настраиваемые веб-шаблоны, которые функционально близки к определению узлов, доступны и в решениях NCSS, и в Надстройки SharePoint. Дополнительные сведения см. в разделе [Работа с шаблонами и определениями](http://msdn.microsoft.com/library/1edf6d4d-eddb-4cb5-9034-ed394e8a3e01%28Office.15%29.aspx).
    
  
- **Замещаемые элементы управления** Дополнительные сведения см. в разделе [Элемент управления Delegate (Control Templatization)](http://msdn.microsoft.com/library/e979328d-4985-4ed6-9085-7ff32a998dfc%28Office.15%29.aspx).
    
  
- **Настраиваемые темы**
    
  
- **Группы пользовательских действий и скрытие пользовательских действий**
    
  
- **Пользовательские элементы управления (файлы ASCX)** не требуются ни одним сценарием.
    
  

### Умеренное использование обработчиков событий надстройки
<a name="AppEventHandlers"> </a>

Некоторые ограничения Надстройки SharePoint можно преодолеть, создавая обработчики событий установки, обновления и удаления надстройки. Эти обработчики  веб-службы, которые размещены на веб-серверах вне фермы SharePoint, возможно в облаке. Они могут использовать клиентскую объектную модель SharePoint или REST API для выполнения операций CRUD для компонентов SharePoint, включая компоненты хост-сайта. Теоретически можно использовать такие обработчики для преодоления некоторых ограничений развертывания элементов **фирменной символики** и **шаблонных расширений**, о которых говорилось ранее. Тем не менее, мы рекомендуем использовать такие обработчики только в крайнем случае, когда нет других способов предоставления клиентам функциональных возможностей, необходимых для вашего варианта использования. Принимая решение создать обработчик, учитывайте указанные ниже факторы.
  
    
    

- Для программного развертывания на хост-сайте необходимо, чтобы надстройка запрашивала разрешение на полный доступ к хост-сайту. Надстройки, для которых необходим данный уровень разрешений, не могут продаваться через Магазин Office.
    
  
- Развертывание компонентов на хост-сайте обычно нарушает преимущества безопасности перевода компонентов SharePoint на сайт надстройки с собственного домена.
    
  
- Создание полного кода развертывания требует выполнения большого количества работы и отладки по сравнению с описанием исправлений развертывания, которое можно использовать для веб-компонентов надстроек и для решений NCSS.
    
  
- Существуют несколько важных рекомендаций, которые необходимо соблюдать при создании обработчиков событий надстройки. Код должен включать логику отката для отмены всех действий при обнаружении ошибки. Он должен также оповещать инфраструктуру SharePoint об ошибке, чтобы инфраструктура могла откатить назад все действия.
    
  
- Обработчики событий надстройки несовместимы с типом Надстройка SharePoint, известным как размещаемый в SharePoint.
    
  
Дополнительные сведения об обработчиках событий надстройки см. в узле SDK  [Обработка событий в надстройках SharePoint](http://msdn.microsoft.com/library/c050d056-8548-4496-a053-016779d723d9%28Office.15%29.aspx). Сведения о логике отката см. в разделе **Добавление логики отката в обработчик** статьи [Создание обработчика для события обновления в надстройках для SharePoint](http://msdn.microsoft.com/library/0fa088c5-54c6-482c-84ed-51c4f77c4127%28Office.15%29.aspx). В последней статье внимание уделяется событию обновления надстройки, но основные принципы относятся ко всем обработчикам событий надстройки.
  
    
    

### Надстройки, создающие расширения
<a name="ExtensionFactories"> </a>

Клиентскую объектную модель SharePoint или ее REST API также можно использовать для устранения неполадок развертывания компонента с Надстройки SharePoint, поместив код CRUD внутрь самой надстройки вместо обработчика событий надстройки. Надстройка становится своего рода фабрикой для какого-либо типа пользовательского расширения. Например, размещаемая в SharePoint надстройка может использовать объектную модель JavaScriptSharePoint для выполнения развертывания и других операций CRUD на хост-сайте или в любом приложении владельца или веб-приложения. Другие примеры см. в подразделе **Краткое введение в удаленную подготовку** раздела [Методики подготовки сайта и удаленная подготовка в SharePoint 2013](http://blogs.msdn.com/b/vesku/archive/2013/08/23/site-provisioning-techniques-and-remote-provisioning-in-sharepoint-2013.aspx), где описано, как размещенное у поставщика Надстройка SharePoint используется для подготовки дочернего сайта, что во многом подобно подготовке дочернего сайта SharePoint "в ящике". Однако приходится выполнять много лишней работы, создавая фабричное Надстройка SharePoint. Более того, надстройки этого типа не продаются в Магазин Office, потому что им необходим полный доступ к хост-сайту.
  
    
    

## Дополнительные ресурсы
<a name="bk_addresources"> </a>


-  [Модели программирования в SharePoint 2013](programming-models-in-sharepoint-2013.md)
    
  
-  [Использование решений](http://msdn.microsoft.com/library/0da0518c-24eb-48e0-89bd-21282fdeef94%28Office.15%29.aspx)
    
  

