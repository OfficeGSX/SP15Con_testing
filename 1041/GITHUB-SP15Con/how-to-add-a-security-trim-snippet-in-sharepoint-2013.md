---
title: SharePoint 2013 でセキュリティによるトリミングのスニペットを追加する方法
ms.prod: SHAREPOINT
ms.assetid: 4beaab08-760b-408a-b768-906312779379
---


# SharePoint 2013 でセキュリティによるトリミングのスニペットを追加する方法
セキュリティによるトリミングのスニペットを使用することにより、ユーザーの持っている特定のアクセス許可、あるいはユーザーが承認されているか、または匿名であるかに基づいて、特定のユーザーに対してのみコンテンツを表示できます。
## セキュリティによるトリミングのスニペットの概要
<a name="Introduction"> </a>

セキュリティによるトリミングのスニペットを使用することにより、ユーザーの持っている特定のアクセス許可、あるいはユーザーが承認されているか、または匿名であるかに基づいて、特定のユーザーに対してのみコンテンツを表示できます。マスター ページまたはページ レイアウトに、セキュリティ トリミング パネルを追加できます。セキュリティ トリミング パネルは、一種のコンテナーであり、静的コンテンツだけではなく、その他のコンポーネントやスニペット (Web パーツなど) を含めることもできます。
  
    
    
たとえば、セキュリティ トリミング パネルを使用して、以下のコンテンツを特定のユーザーに表示することができます。
  
    
    

- 認証されたユーザーが現在作業しているドキュメントを示す、検索 Web パーツによるコンテンツ。
    
  
- 認証されたユーザーがサイトで新しくなった内容を確認できる、最近変更されたドキュメントのリスト ビュー。
    
  
- 認証されていない訪問者に対して、現在の記事に基づく推奨リンクのリストを表示する、検索 Web パーツによるコンテンツ。このような推奨項目のリストはサイトで作業している認証されたコンテンツ作成者にとっては邪魔かもしれませんが、認証されていない訪問者にとっては重要です。
    
  
- 認証されていないユーザー、またはまだ認証されていないユーザー用の、リボンから分離されたサインイン リンク。
    
    > **メモ**
      <br/> このサインイン リンクは、デザイン マネージャーを使用して作成されたマスター ページに自動的に挿入されますが、必要なければ削除してもかまいません。 
セキュリティ トリミング パネルには 2 つの重要なプロパティ設定があります。1 つは認証に関するもので、もう 1 つは許可 (または承認) に関するものです。たとえば、セキュリティ トリミング パネルを使用すると、以下のコンテンツを特定のユーザーに表示できます。
  
    
    

- **AuthenticationRestrictions** このプロパティを使用すると、パネルを、認証されたユーザーや匿名ユーザーに限定することも、すべてのユーザー (既定の設定はすべてのユーザー) を選択することもできます。
    
  
- **Permissions** このプロパティを使用すると、パネルのコンテンツを参照するためにユーザーが持つ必要がある、特定のアクセス許可を選択できます。
    
    > **メモ**
      <br/> アクセス許可レベルではなく、個々のアクセス許可を選択します (アクセス許可レベルとは、付与されたアクセス許可のセットです)。 
当然のことながら、認証を匿名ユーザーのみに制限した場合、匿名ユーザーには通常 SharePoint 2013 アクセス許可が何も付与されていないので、特定のアクセス許可を指定する必要はありません。アクセス権限は、すべてのユーザーまたはすべての認証されたユーザーでのみ使用するのが適切です。
  
    
    
表 1 の左側の列に表示しているように、セキュリティ トリミング パネルには 3 つのオプションがあります。表 1 では、ユーザーに必要な特定のアクセス許可をこれらの設定で決定する方法、特定のアクセス許可が含まれる最も低い既定のアクセス許可レベル、既定でそのアクセス許可レベルにリンクされるグループを示しています。
  
    
    

> **メモ**
> これらは既定の設定であり、サイト コレクション、サイト、リスト、またはアイテムなど、対象の範囲について変更できます。 
  
    
    

たとえば、セキュリティ トリミング パネルを [ **作成者に表示**] に設定した場合、デフォルトでは、メンバー グループと所有者グループのユーザーがこのパネル内のコンテンツを表示できます。
  
    
    

**表 1 既定のアクセス許可レベルとグループにパネル オプションをマップする**


|**セキュリティ トリミング パネル オプション**|**アクセス許可のプロパティ**|**アクセス許可**|**アクセス許可レベル**|**グループ**|
|:-----|:-----|:-----|:-----|:-----|
|作成者に表示  <br/> |**AddAndCustomizePages** <br/> |ページの追加とカスタマイズ  <br/> |投稿 (またはそれ以上)  <br/> |メンバー  <br/> |
|認証されたユーザーに表示  <br/> |**ViewPages** <br/> |ページの閲覧  <br/> |読み取り (またはそれ以上)  <br/> |ビジター  <br/> |
|管理者に表示  <br/> |**FullMask** <br/> |すべてを選択  <br/> |フル コントロール  <br/> |所有者  <br/> |
   

### セキュリティ トリミング パネルの挿入
<a name="InsertSnippet"> </a>

すべてのスニペットと同様に、セキュリティによるトリミングのスニペットはスニペット ギャラリーから追加します。スニペット ギャラリーに移動するにはまず、編集するマスター ページまたはページ レイアウトを選択する必要があります。
  
    
    

### セキュリティ トリミング パネルを挿入するには


1. 発行サイトに移動します。
    
  
2. ページの右上隅で、歯車の形の [設定] アイコンをクリックし、[ **デザイン マネージャー**] をクリックします。
    
  
3. デザイン マネージャーの左のナビゲーション ウィンドウで、編集しているファイルの種類によって、[ **マスター ページの編集**] または [ **ページ レイアウトの編集**] をクリックします。
    
  
4. スニペットを追加するマスター ページまたはページ レイアウトの名前を選択します。
    
  
5. スニペット ギャラリーを開くには、サーバー側プレビューの右上隅で、[ **スニペット**] をクリックします。
    
  
6. リボンの [ **設計**] タブで、[ **セキュリティ トリミング**] を選択します。
    
    オプションとして、[ **セキュリティ トリミング**] ボタンのドロップダウン リストで、パネルのコンテンツを閲覧できるユーザーを選択したり、パネルの重要なプロパティ値を設定することでより多くのオプションを表示したりすることもできます。
    
  
7. スニペット ギャラリーの右側の [ **このコンポーネントについて**] の下で、セクション ヘッダーをクリックまたは選択して、プロパティのグループを展開するか、折りたたむかして、必要なカスタム設定を構成します。
    
  
8. プロパティを構成した後、[ **更新**] をクリックします。これによって、ページの左側の HTML スニペットが更新され、マークアップにカスタム設定が反映されます。いつでも [ **リセット**] をクリックして、すべてのプロパティを既定の設定に戻すことができます。
    
  
9. スニペット ギャラリーの左側で、[ **HTML スニペット**] の下の [ **クリップボードにコピー**] をクリックします。
    
  
10. HTML エディターで、コンピューター上のマップされたネットワーク ドライブを開き、スニペットを追加するマスター ページまたはページ レイアウトの HTML ファイルを開きます。
    
  
11. HTML ファイルの中の、マークアップを表示する場所にスニペットを貼り付けます。
    
    ページ レイアウトにスニペットを追加している場合は、 **PlaceHolderMain** の内部にスニペットを貼り付けてください。
    
  
12.  `class="DefaultContentBlock"` の **<div>** を独自のコンテンツに置き換えます。
    
  
13. ページを保存し、デザイン マネージャーでサーバー側のプレビューを更新して、セキュリティ トリミング パネルが意図したとおりに表示されることを確認します。
    
  

## スニペット マークアップの理解
<a name="UnderstandMarkup"> </a>

セキュリティによるトリミングのスニペットで最も重要な部分は、 **AuthenticationRestrictions** プロパティと、 **Permissions** プロパティと、以下に示す太字の **<div>** です。 **AuthenticationRestrictions** は、既定値である **AllUsers** から別の値に変更した場合にのみマークアップに表示されます。スニペット ギャラリーでスニペットに対して [ **リセット**] を選択すると、 **AuthenticationRestrictions** がマークアップから削除され、スニペットは既定値である **AllUsers** を使用するようになります。
  
    
    
 `class="DefaultContentBlock"` である **<div>** は、独自のコンテンツに置き換える部分であり、他のスニペットおよびコントロールを含むことができます。
  
    
    



```HTML

<div data-name="SecurityTrimmedAuthors">
    <!--CS: Start Security Trim Snippet-->
    <!--SPM:<%@Register Tagprefix="SharePoint" Namespace="Microsoft.SharePoint.WebControls" Assembly="Microsoft.SharePoint, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c"%>-->
    <!--MS:<SharePoint:SPSecurityTrimmedControl runat="server" AuthenticationRestrictions="AuthenticatedUsersOnly" Permissions="AddAndCustomizePages" PermissionContext="RootSite">-->
        <!--PS: Start of READ-ONLY PREVIEW (do not modify)--><span><!--PE: End of READ-ONLY PREVIEW-->
        <div class="DefaultContentBlock" style="border:medium black solid; background:yellow; color:black; margin:20px; padding:10px;">
        You should replace this div with content that renders based on your Security Trim Properties.
        </div>
        <!--PS: Start of READ-ONLY PREVIEW (do not modify)--></span><!--PE: End of READ-ONLY PREVIEW-->
    <!--ME:</SharePoint:SPSecurityTrimmedControl>-->
    <!--CE: End Security Trim Snippet-->
</div>
```


## その他の技術情報
<a name="AdditionalResources"> </a>


-  [概要: 権限を使ったユーザー アクセスの制御](http://office.microsoft.com/ja-jp/sharepoint-foundation-help/introduction-control-user-access-with-permissions-HA102771919.aspx?CTT=1)
    
  
-  [権限レベルについて](http://office.microsoft.com/ja-jp/products/default-permission-levels-HA102772313.aspx?CTT=5&amp;origin=HA102771919)
    
  
-  [SharePoint 2013 デザイン マネージャー スニペット](sharepoint-2013-design-manager-snippets.md)
    
  
-  [SharePoint サイトの構築](build-sites-for-sharepoint.md)
    
  
-  [SharePoint 2013 のサイト デザインの開発](develop-the-site-design-in-sharepoint-2013.md)
    
  

