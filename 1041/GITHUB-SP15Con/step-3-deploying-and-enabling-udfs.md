---
title: ステップ 3 UDF を展開して有効にする
ms.prod: OFFICE365
ms.assetid: 1e5e2a0a-041a-481c-a18b-578562a60e24
---


# ステップ 3: UDF を展開して有効にする

この手順では、以下の操作を実行します。
  
    
    


1. SampleUdf.dll (「 [ステップ 2: マネージ コード UDF を作成する](step-2-creating-a-managed-code-udf.md)」で作成したもの) を、Microsoft SharePoint Server 2010 がインストールされているコンピューターのフォルダーに展開します。
    
  
2. ユーザー定義関数 (UDF) を特定の信頼できる場所 (たとえば、信頼できる共有ドキュメントの保存場所) から呼び出せるようにします。 
    
  
3. SampleUdf.dll を有効にします。
    
  

## UDF を展開する


### UDF を展開するには


1. UDF を展開する予定のコンピューターのローカル ドライブに "UDFs" という名前のフォルダーを作成します。たとえば、"C:\\UDFs" です。
    
  
2. SampleUdf.dll アセンブリをコピーします。
    
  
3. SampleUdf.dll を "C:\\UDFs" に保存します。 
    
  

## 場所を信頼する


### 場所を信頼するには


1. [ **スタート**] メニューで、[ **すべてのプログラム**] をクリックします。 
    
  
2. [ **Microsoft SharePoint 2010 製品**] をポイントし、[ **SharePoint サーバーの全体管理**] をクリックします。 
    
  
3. [ **アプリケーション構成の管理**] の下で、[ **サービス アプリケーションの管理**] をクリックします。
    
  
4. [サービス アプリケーションの管理] ページで、[ **Excel Services Application**] をクリックします。
    
  
5. [ **Excel Services Application**] ページで、[ **信頼できるファイル保存場所**] をクリックします。
    
  
6. [信頼できるファイル保存場所] ページで、[ **信頼できるファイル保存場所の追加**] をクリックします。 
    
  
7. [信頼できるファイル保存場所の追加] ページの [ **アドレス**] ボックスに、ブックを保存する場所を入力します。例:  _http://MyServer002/Shared%20Documents_。 
    
  
8. [ **場所の種類**] の下で、該当する場所の種類をクリックします。この例では、[Microsoft SharePoint Foundation] を選択してください。
    
  
9. 子のライブラリまたはディレクトリを信頼するには、[ **子の信頼**] の下で [ **子の信頼**] を選択します。
    
  
10. [ **ユーザー定義関数を使用可能にする**] の下で [ **ユーザー定義関数が使用可能**] を選択することにより、この信頼できる場所に保存されたブックから UDF を呼び出せるようにします。
    
  
11. [ **OK**] をクリックします。
    
  

## UDF を有効にする

以下の手順を実行するには、SharePoint Server 2010 がインストールされたコンピューターが必要です。
  
    
    

### UDF を有効にするには


1. 前の手順 (「場所を信頼するには」) のステップ 1 から 3 を実行して、SSP の [共有サービス] ホーム ページを表示します。
    
  
2. [ **Excel Services の設定**] の下で、[ **ユーザー定義関数アセンブリ**] をクリックします。 
    
  
3. [Excel Services: ユーザー定義関数] ページで、[ **ユーザー定義関数の追加**] をクリックし、[Excel ****Services: ユーザー定義関数アセンブリの追加] ページを開きます。
    
  
4. [ **Assembly**] ボックスに、SampleUdf.dll アセンブリへのパスを入力します。この例では、 _C:\\UDFs\\SampleUdf.dll_ です。
    
  
5. [ **アセンブリの場所**] の下で、[ **ファイル パス**] をクリックします。
    
  
6. [ **アセンブリを使用可能にする**] の下で、[ **アセンブリが使用可能**] チェック ボックスが既定でオンになっているはずです。
    
  
7. [ **OK**] をクリックします。
    
  

## 堅牢なプログラミング

UDF 呼び出しを含むブックでセッションが開始された時、 **AllowUdfs** 値が **false** であると、UDF 呼び出しは失敗します。
  
    
    

> **メモ**
> **AllowUdfs** フラグは、[ **ユーザー定義関数が使用可能**] オプション (「場所を信頼する」セクションのステップ 9 を参照) で示されています。 
  
    
    

セッションが開始した後に **AllowUdfs** 値を **true** に変更した場合にも、UDF 呼び出しは失敗します。これは、 **AllowUdfs** フラグの変更が次回のセッションで有効になるからです。Microsoft インターネット インフォメーション サービス (IIS) をリセットして、これを回避することができます。IIS をリセットすると、UDF が再読み込みされます。
  
    
    
IIS のリセットに関する詳細は、「 [UDF を有効にする方法](how-to-enable-udfs.md)」を参照してください。
  
    
    

## 関連項目


#### タスク


  
    
    
 [ステップ 1: プロジェクトを作成し、UDF への参照を追加する](step-1-creating-a-project-and-adding-a-udf-reference.md)
  
    
    
 [ステップ 2: マネージ コード UDF を作成する](step-2-creating-a-managed-code-udf.md)
  
    
    
 [手順 4: セルから UDF のテストと呼び出しを行う](step-4-testing-and-calling-udfs-from-cells.md)
  
    
    
 [UDF を有効にする方法](how-to-enable-udfs.md)
#### 概念


  
    
    
 [チュートリアル: マネージ コード UDF を開発する](walkthrough-developing-a-managed-code-udf.md)
  
    
    
 [Excel Services UDF の理解](understanding-excel-services-udfs.md)
