---
title: [方法] SharePoint 2013 で Web パーツ領域スニペットを追加する
ms.prod: SHAREPOINT
ms.assetid: 7583b217-200c-4569-8f88-fe975c8ebd72
---


# [方法]: SharePoint 2013 で Web パーツ領域スニペットを追加する
Web パーツ領域は、ページ レイアウトに追加できるスニペットで、コンテンツ作成者はその領域内で Web パーツを追加、編集、または削除できます。
## Web パーツ領域スニペットの概要
<a name="Introduction"> </a>

Web パーツとは特定の SharePoint 機能を提供するサーバー コントロールで、Web パーツ領域とはその領域に含まれる Web パーツのレイアウト、動作、およびその他のプロパティを決定するコンテナーです。たとえば、Web パーツ領域によって、領域内の Web パーツに対して次の指定を行うことができます。
  
    
    

- 水平レイアウトで配置するか、垂直レイアウトで配置するか。 
    
  
- タイトル バーや境界線などの共通ユーザー インターフェイス (UI) 要素を表示するかどうか。
    
  
- コンテンツ作成者がブラウザーでページを編集するときにカスタマイズできるかどうか。
    
  
- Web パーツの個人用ビューを作成するサイトの閲覧者がブラウザーでページを表示するときにパーソナライズできるかどうか。
    
  
発行サイトでは、必要なアクセス許可を持つコンテンツ作成者は、ページ ライブラリ内にあるページを作成または編集できます。デザイナーは、Web パーツ領域をページ レイアウトに追加できます。コンテンツ作成者がそのページ レイアウトに基づいてページを作成または編集する場合、その領域内の Web パーツを追加、編集、または削除できます。たとえば、ページ レイアウトに Web パーツ領域を追加する場合、コンテンツ作成者は次のことを実行できます。
  
    
    

- コンテンツ検索 Web パーツを使用して、検索クエリの結果を表示する。検索型 Web パーツが Web パーツ領域内にある場合、作成者は検索クエリを更新または変更できます。
    
  
- メディア Web パーツを使用して、ビデオまたは音声クリップを Web ページに組み込む。
    
  
- 概要リンク Web パーツを使用して、簡単に編集、グループ化、または並べ替えることができるハイパーリンクの一覧を作成する。
    
  
- 目次 Web パーツを使用して、サイト内のすべてのページを一覧表示し、ページが追加、削除、名前変更、または移動されると必ず自動的に更新されるサイト マップを作成する。
    
  

### Web パーツ領域を使用する状況

ページ レイアウトに 1 つまたは複数の Web パーツ領域が含まれる場合、そのレイアウトを使用するすべてのページで Web パーツ領域を使用でき、作成者はそれらのページに Web パーツを挿入できます。作成者がページに Web パーツを挿入できるようにすると、そのサイトのユーザー エクスペリエンスを制御しにくくなります。たとえば、作成者は、現在のページから閲覧者を移動させたくないサイトのパーツを公開するページに目次 Web パーツを挿入できます。
  
    
    
サイトでの Web パーツの表示方法を完全に制御する場合、および Web パーツを特定の種類のすべてのページに表示させる場合は、Web パーツをページ レイアウトに直接追加します。Web パーツをサイト内のすべてのページに表示させる場合は、Web パーツをマスター ページに直接追加することもできます。
  
    
    

> **メモ**
> Web パーツ領域は、ページ レイアウト上では使用できますが、マスター ページ上では使用できません。Web パーツ領域は作成者が Web パーツを変更できるようにするためのものであり、作成者は通常はマスター ページを編集しないからです。 
  
    
    

Web パーツ領域をページ レイアウトに追加する一方、Web パーツ領域の使用を制限することもできます。たとえば、Web パーツを領域に追加し、コンテンツ作成者が既存の Web パーツのプロパティは編集できるが、Web パーツを領域から追加または削除できないように、その領域のプロパティを設定できます。Web パーツ領域には、2 つの役割を果たす一連のプロパティがあります。プロパティの一方のサブセットを使用すると、ページ上の Web パーツのレイアウトとフォーマットを整理できます。もう一方のサブセットを使用すると、領域内の Web パーツの変更を詳細レベルで保護する ("ロック ダウン") ことができます。
  
    
    
サイト上の Web パーツの表示方法をさまざまなレベルで制御するため、次のことを実行できます。
  
    
    

- Web パーツをマスター ページまたはページ レイアウトに直接追加する。これは、コンテンツ作成者が Web パーツを変更できないということを意味します。
    
  
- Web パーツをページ レイアウト上の領域に追加するが、追加する既定の Web パーツのみにその領域を制限する。
    
  
- Web パーツ領域をページ レイアウトに追加し、その領域内に表示する Web パーツとその設定方法について、コンテンツ作成者が完全に制御できるようにする。
    
  
Web パーツ領域のプロパティで、次のものの変更をコンテンツ作成者に許可するかどうかを指定できます。
  
    
    

- Web パーツの追加、削除、サイズ変更、または移動による、領域内の Web パーツのレイアウト。
    
  
- すべてのユーザー用の Web パーツ設定 (Web パーツの共有ビュー)。
    
  
- コンテンツ作成者の個人用 Web パーツ設定 (Web パーツの個人用ビュー)。
    
  
表 1 に、Web パーツ領域を制限する場合に考慮すべき重要なプロパティを示します。
  
    
    

**表 1. コンテンツ作成者の制限に使用される Web パーツ領域のプロパティ**


|**プロパティ名**|**説明**|
|:-----|:-----|
|**AllowLayoutChange** <br/> |領域内の Web パーツのクローズ、最小化、削除、復元を行えるかどうかを指定します。  <br/> **False** に設定した場合、ユーザーは領域内の Web パーツをクローズ、最小化、削除、または復元したり、Web パーツを別の領域にドラッグしたり、領域内の Web パーツを再配置または移動したりできません。Web パーツ カタログから Web パーツを追加することもできません。領域内の Web パーツの UI に影響を与えるいくつかのプロパティが無効になります。このプロパティは、レイアウトをプログラムによって変更する機能には影響を与えません。 <br/> **True** に設定した場合、適切なアクセス許可を持つユーザーはこれらのアクションを実行できます。 <br/> |
|**LockLayout** <br/> |領域内の Web パーツを追加、削除、サイズ変更、または移動できるかどうかを指定します。このプロパティは、Web パーツ ページが個人用ビューでも共有ビューでも同じように機能します。  <br/> **True** に設定した場合、領域内の各 Web パーツで影響を受ける Web パーツのプロパティは、[ **領域 (ZoneID)**]、[ **パーツの順序 (PartOrder)**]、[ **ページ上で表示する (IsVisible)**]、[ **高さ (Height)**]、[ **幅 (Width)**]、[ **閉じるのを許可する (AllowRemove)**]、および [ **IsIncluded**] ([ **Web パーツ**] メニューの [ **閉じる**] コマンド) です。その他の Web パーツのプロパティは影響を受けません。  <br/> **False** に設定した場合、Web パーツのプロパティによって、(適切なサイト アクセス許可で) 変更を行えるかどうかが決まります。 <br/> |
|**AllowCustomization** <br/> |領域内の Web パーツの共有プロパティ値を変更できるかどうかを指定します。  <br/> **True** に設定した場合、適切なアクセス許可を持つユーザーは、すべてのユーザー用に領域内の Web パーツを変更できます。 <br/> **False** に設定した場合、ユーザーは共有ビューの UI で領域内の Web パーツを変更することはできません。ただし、プログラムによって、および Web パーツのメンテナンス ページを使用して、引き続き変更できます。 <br/> |
|**AllowPersonalization** <br/> |領域内の Web パーツの個人用プロパティ値を変更できるかどうかを指定します。  <br/> **True** に設定した場合、適切なアクセス許可を持つユーザーは、領域内の Web パーツに対して個人用の変更を行うことができます。 <br/> **False** に設定した場合は、Web パーツがプライベート Web パーツで、ユーザーに適切なアクセス許可がない限り、ユーザーは UI で Web パーツに個人用の変更を行うことはできません。 <br/> |
   

> **メモ**
> デバイス チャネル パネル内に Web パーツ領域を挿入することはできません。作成者が Web パーツをページに追加できるようにする場合、およびモバイル デバイス向けのページの重さを気にしない場合は、リッチ テキスト エディター ページ フィールドをデバイス チャネル パネルに追加し、そこに Web パーツを追加するように作成者に指示できます。Web パーツをデバイス チャネル パネルに直接 (Web パーツ領域を使用せずに) 追加できます。詳細については、「 [SharePoint Server 2013 でのデバイス チャネル パネル スニペットを追加する方法](how-to-add-a-device-channel-panel-snippet-in-sharepoint-2013.md)」を参照してください。 
  
    
    


## Web パーツ領域スニペットの挿入
<a name="InsertSnippet"> </a>

すべてのスニペットと同様に、このスニペットをスニペット ギャラリーから追加します。スニペット ギャラリーに移動するには、まず編集するページ レイアウトを選択します。Web パーツ領域はページ レイアウトには追加できますが、マスター ページには追加できません。
  
    
    

### Web パーツ領域スニペットを挿入するには


1. 発行サイトに移動します。
    
  
2. ページの右上隅で、歯車の形の [設定] アイコンをクリックし、[ **デザイン マネージャー**] をクリックします。
    
  
3. デザイン マネージャーの左側のナビゲーション ウィンドウで、[ **ページ レイアウトの編集**] を選択します。
    
  
4. スニペットを追加するページ レイアウトの名前を選択します。
    
  
5. スニペット ギャラリーを開くには、サーバー側プレビューの右上隅で、[ **スニペット**] をクリックします。
    
  
6. リボンの [ **デザイン**] タブで、[ **Web パーツ領域**] を選択します。
    
  
7. スニペット ギャラリーの右側の [ **このコンポーネントについて**] の下で、セクション ヘッダーをクリックまたは選択して、プロパティのグループを展開するか、折りたたむかして、必要なカスタム設定を構成します。
    
    [ **重要**] という名前のセクションには、この特定のスニペットの動作にとって重要なプロパティが含まれます。Web パーツ領域の場合、スニペットには一意の ID があります。スニペットをページ レイアウトにコピーした後で、この ID を再利用しないでください。別の Web パーツ領域スニペットを追加する場合は、[ **最新の情報に更新**] を選択して、次のスニペットに対して新しい ID を生成します。
    
    Web パーツ領域の制限に必要なプロパティ ( **LockLayout**、 **AllowCustomization**、および **AllowPersonalization**) については、表 1 を参照してください。
    
    > **メモ**
      > スニペット ギャラリーのプロパティ グリッドに、プロパティ名が太字で表示されることがあります。これらのプロパティの値は、このコンポーネントの既定の設定から変更されていますが、必ずしもデザイナー シナリオに関連しているわけではありません。つまり、プロパティが太字で表示されていても、シナリオにとって必ずしも重要ではありません。 
8. プロパティを構成した後、[ **更新**] をクリックします。これによって、ページの左側の HTML スニペットが更新され、マークアップにカスタム設定が反映されます。いつでも [ **リセット**] をクリックして、すべてのプロパティを既定の設定に戻すことができます。
    
  
9. スニペット ギャラリーの左側で、[ **HTML スニペット**] の下の [ **クリップボードにコピー**] をクリックします。
    
  
10. HTML エディターで、コンピューター上のマップされたネットワーク ドライブを開き、スニペットを追加するマスター ページまたはページ レイアウトの HTML ファイルを開きます。
    
    詳細については、「 [[方法]: SharePoint 2013 マスター ページ ギャラリーへのネットワーク ドライブの割り当て](how-to-map-a-network-drive-to-the-sharepoint-2013-master-page-gallery.md)」を参照してください。
    
  
11. HTML ファイルの中の、マークアップを表示する場所にスニペットを貼り付けます。
    
    スニペットをページ レイアウトに追加する場合は、スニペットを **PlaceHolderMain** の内側に貼り付けてください。
    
  
12.  `class="DefaultContentBlock"` の **<div>** を独自のコンテンツに置き換えます。
    
  
13. Web パーツを持つ領域を事前作成する場合 (コンテンツ作成者が既存 Web パーツのみ変更可能で、新しい Web パーツを追加できないようにその領域を制限する場合など) は、 **<!--DC … -->** タグを表示する場所に Web パーツ スニペットを挿入します。
    
  
14. ページを保存し、デザイン マネージャーでサーバー側プレビューを再表示して、ページが期待どおりに表示されることを確認します。
    
  

## スニペット マークアップの理解
<a name="UnderstandMarkup"> </a>

Web パーツ領域スニペットの最も重要な 2 つの部分は、[ **ID**] プロパティと **<!--DC … -->** コメントです。領域ごとに一意の ID を持つ必要があります。複数の Web パーツ領域をページ レイアウトに追加する場合は、各スニペットをコピーする前にスニペット ギャラリーで [ **最新の情報に更新**] を選択して、新しい ID を生成します。 **<!--DC … -->** コメントは、既定では領域に表示させる任意の Web パーツに置き換えられます。
  
    
    
コンテンツ作成者による領域の使用方法を制御するために使用できるその他のプロパティ ( **AllowCustomization**、 **AllowPersonalization**、および **LockLayout**) を次のコードに示します。
  
    
    

> **メモ**
> **AllowCustomization**、 **AllowPersonalization**、および **LockLayout** プロパティは、プロパティ グリッドで既定値を変更した場合にのみマークアップに表示されます。
  
    
    




```HTML

<div data-name="WebPartZone">
    <!--CS: Start Web Part Zone Snippet-->
    <!--SPM:<%@Register Tagprefix="WebPartPages" Namespace="Microsoft.SharePoint.WebPartPages" Assembly="Microsoft.SharePoint, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c"%>-->
    <div xmlns:ie="ie">
        <!--MS:<WebPartPages:WebPartZone runat="server" ID="x0e5f5212505f48a9aac43df13eeae4f9" AllowCustomization="True" AllowPersonalization="False" FrameType="TitleBarOnly" LockLayout="True" Orientation="Vertical">-->
            <!--MS:<ZoneTemplate>-->
               <!--DC: Replace this comment with default web parts for new pages. -->
            <!--ME:</ZoneTemplate>-->
        <!--ME:</WebPartPages:WebPartZone>-->
    </div>
    <!--CE: End Web Part Zone Snippet-->
</div>

```


## その他の技術情報
<a name="AdditionalResources"> </a>


-  [SharePoint 2013 デザイン マネージャー スニペット](sharepoint-2013-design-manager-snippets.md)
    
  
-  [WebPartZone クラス](http://msdn.microsoft.com/ja-jp/library/system.web.ui.webcontrols.webparts.webpartzone.aspx)
    
  
-  [WebPartZoneBase プロパティ](http://msdn.microsoft.com/ja-jp/library/335sw9k3.aspx)
    
  
-  [SharePoint サイトの構築](build-sites-for-sharepoint.md)
    
  
-  [SharePoint 2013 のサイト デザインの開発](develop-the-site-design-in-sharepoint-2013.md)
    
  

