---
title: 手順 4 セルから UDF のテストと呼び出しを行う
ms.prod: SHAREPOINT
ms.assetid: d3e6aa72-2eb8-4b4b-a0eb-273486890d00
---


# 手順 4: セルから UDF のテストと呼び出しを行う

この手順では、前の手順で作成、配置し、有効にした SampleUdf.dll アセンブリをテストします。ユーザー定義関数 (UDF) をテストするには以下を行います。
  
    
    


1. 名前付き範囲と SampleUdf.dll 内の関数を呼び出す数式を持つブックを作成します。
    
  
2. このブックは、信頼できる場所である SharePoint ドキュメント ライブラリに保存します。
    
    > **メモ**
      > 既に SharePoint ドキュメント ライブラリが作成され、信頼できる場所にしてあることが前提です。場所を信頼する方法について、詳細は  [ステップ 3: UDF を展開して有効にする](step-3-deploying-and-enabling-udfs.md) の「場所の信頼」セクションを参照してください。
3. ブックを再計算するようパラメーターを変更します。
    
  

## UDF のテスト


### セルから UDF を呼び出すには


1. Microsoft Office Excel 2007 を起動します。
    
  
2. セル A1 に、SampleUdf.dll 内の  `MyDouble` 関数を呼び出す数式を入力します。 `MyDouble` 関数は、型が **double** の引数を受け取ります。この例では、セル B1 から引数をとっています。セル A1 に「=MyDouble(B1)」と入力します。
    
    > **メモ**
      > 数式は、Excel で「#NAME?」と評価されます。数式は、ブックが Excel Services に表示される場合のみ評価されます。 

    > **メモ**
      > UDF はクライアントとサーバーの両方で実行できます。MSDN で発行される今後の記事で詳細を説明します。簡略化のためにここでは割愛します。 
3. セル B1 に数字の 8 を入力します。
    
  
4. セル B1 を名前付き範囲にします。まず [ **数式**] タブをクリックします。続いてセル B1 をクリックして選択します。[ **数式**] タブの [ **名前付きセル**] グループで、[ **範囲に名前を付ける**] をクリックします。[ **新しい名前**] ダイアログ ボックスの [ **名前**] ボックスに、「 **MyDoubleParam**」と入力します。
    
  
5. セル A2 に、 `ReturnDateTimeToday` 関数を呼び出す数式を入力します。「=ReturnDateTimeToday()」と入力します。
    
  
6. セル A3 に、 `ReturnDateTimeToday` 関数を呼び出す数式を入力します。「=ReturnDateTimeToday()」と入力します。次に、セル A3 を右クリックしてメニューを表示します。[ **セルの書式設定**] をクリックします。
    
  
7. [ **セルの書式設定**] ダイアログ ボックスの [ **数値**] タブで、[ **日付**] を選択します。[ **種類**] リストから日付書式設定の種類 (たとえば、「*2001/3/14」) を選択します。
    
  
8. [ **OK**] をクリックします。
    
  
9. ローカル ドライブ上の任意の場所にブックを保存します。 ブックに「TestSampleUdf.xlsx」という名前を付けます。 
    
  

### Excel Services に保存するには


1. **Microsoft Office ボタン**をクリックし、[ **名前を付けて保存**] をポイントして、[ **Excel Services に保存**] をクリックします。 
    
  
2. [ **名前を付けて保存**] ダイアログ ボックスで、[ **Excel Services オプション**] をクリックします。
    
  
3. [ **Excel Services のオプション**] ダイアログ ボックスの [ **表示**] タブで、[ **ブック全体**] が選択されていることを確認します。
    
  
4. [ **パラメーター**] をクリックします。 
    
  
5. [ **パラメーターの追加**] リストで、[ **MyDoubleParam**] チェック ボックスを選択します。
    
  
6. [ **OK**] をクリックします。「MyDoubleParam」が [ **パラメーター**] リストに一覧表示されていることが分かります。
    
  
7. [ **OK**] をクリックします。
    
  
8. [ **名前を付けて保存**] ダイアログ ボックスで、[ **保存した後にブラウザーでこのブックを開く**] チェック ボックスが選択されていることを確認します。
    
  
9. [ **ファイル名**] ボックスに、このブックを保存する信頼できる SharePoint ドキュメント ライブラリへのパスを入力します (例:  _http://MyServer002/Shared%20Documents/TestSampleUdf.xlsx_)。
    
  
10. [ **保存**] をクリックします。TestSampleUdf.xlsx が Excel Web Access に表示されます。セル A1 に、数値「72」が表示されます (セル B1 * 9 = 8 * 9 は 72.のため)。セル A2 には数値が表示されているはずです。セル A3 には現在の日付が表示されているはずです。 
    
    > **メモ**
      > セル A2 の数値は、1900 年 1 月 1 日から ([1904 年から計算する] をオンにした場合は 1904 年 1 月 1 日から) の日数を表します。これが、Excel が内部で日付を表す方法です。 

### UDF をテストするパラメーターを変更するには


1. [ **パラメーター**] ウィンドウで、セル B1、つまり「MyDoubleParam」の名前付き範囲が表示されているはずです。 
    
  
2. セル B1 の値を変更するには、「MyDoubleParam」の隣りにあるボックスに数値を入力します。たとえば、「3」と入力してから [ **適用**] をクリックすると、Excel Services はブックを再計算します。セル A1 の内容は「72」ではなく「27」になります。 
    
  

## 関連項目


#### タスク


  
    
    
 [ステップ 1: プロジェクトを作成し、UDF への参照を追加する](step-1-creating-a-project-and-adding-a-udf-reference.md)
  
    
    
 [ステップ 2: マネージ コード UDF を作成する](step-2-creating-a-managed-code-udf.md)
  
    
    
 [ステップ 3: UDF を展開して有効にする](step-3-deploying-and-enabling-udfs.md)
  
    
    
 [方法: Web サービスを呼び出す UDF の作成](how-to-create-a-udf-that-calls-a-web-service.md)
#### 概念


  
    
    
 [チュートリアル: マネージ コード UDF を開発する](walkthrough-developing-a-managed-code-udf.md)
  
    
    
 [Excel Services UDF の理解](understanding-excel-services-udfs.md)
