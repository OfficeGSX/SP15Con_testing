---
title: SharePoint Designer および Visio でのワークフロー開発
ms.prod: SHAREPOINT
ms.assetid: 496780d5-47d6-4a43-bf14-70aefb8d820c
---


# SharePoint Designer および Visio でのワークフロー開発
Visio 2013 および SharePoint Designer 2013 を使用してワークフローを作成し、コード不要で SharePoint 2013 サイトに発行する方法について説明します。
## 概要
<a name="VSSPD_Intro"> </a>

Visio 2013と SharePoint Designer 2013により、ビジネス アナリスト、プロセス コンサルタント、および IT 担当者は共同作業や ワークフローの構築を容易に行うことができます。Visio Professional 2013と、SharePoint Designer 2013のビジュアル デザイナーはどちらも、プログラマとプログラマ以外のユーザーが同じように理解できる形式で、ワークフローを分かりやすく表現します。
  
    
    

> **メモ**
> SharePoint Server 2013 および ワークフロー マネージャー サーバーのセットアップと構成方法については、「 [SharePoint Server 2013 でワークフローを構成する](http://technet.microsoft.com/ja-jp/library/jj658586.aspx)」を参照してください。 
  
    
    

Visio 2013 を使用することにより、SharePoint ワークフローを視覚的に作成し、そのワークフローを SharePoint Designer 2013 にエクスポートして、SharePoint サイトに発行することができます。Visio 2013 でワークフローを作成した後は、そのワークフローを SharePoint Designer 2013 にエクスポートする必要があります。その後、SharePoint サイトの所有者または IT 担当者は、ワークフロー テキスト エディターまたはビジュアル ワークフロー デザイナー (SharePoint Designer 2013 でホストされる Visio 2013 ActiveX コントロール) を使用することにより、そのワークフローにパラメーターを追加します。ワークフローが完成した後は、SharePoint サイトに発行することができます。
  
    
    
ビジネス ロジックを表現したワークフローを設計することができるため、これは Visio のフローチャートにすでに精通しているビジネス アナリストやプロセス コンサルタントにとって理想的なツールです。ワークフローを設計するユーザーは、ワークフローのビジネス インテリジェンス (BI) のニーズにのみ注意を集中することができ、宣言型ワークフローの専門家である必要はありません。
  
    
    

## Visio 2013 および SharePoint Designer 2013 での SharePoint ワークフローの作成について
<a name="VSSPD_About"> </a>

Visio 2013 には、SharePoint 2013 ワークフローを構築するために使用できる SharePoint 2013 ワークフロー テンプレートが組み込まれています。SharePoint 2013 ワークフロー テンプレートは、SharePoint 2013 ワークフロー アクション、SharePoint 2013 ワークフロー条件、および SharePoint 2013 ワークフロー ターミネータの 3 つのステンシルに関連付けられています。これらのステンシル内の図形は、SharePoint 2013 ワークフロー内で使用可能な特定のアクションおよび条件に対応します。ワークフローを構築するときに必要なのは、図形を Visio 2013 の描画キャンバス上にドラッグし、ワークフローの背後にあるビジネス ロジックをモデル化することだけです。
  
    
    

### ステージ、ループ、およびステップ

SharePoint Designer 2013 のワークフローには、ステージ、ループ、およびステップの概念が導入されています。ワークフローの作成者は、個々のアクションおよび条件のいくつかを 1 つの単位としてグループ化し、プロセスをより明確に定義できます。たとえば、「承認」または「フィードバックの要求」というステージまたはステップがあるとします。そのステージまたはステップ内には、プロセスで必要なアクションがすべて含まれています。ステージまたはステップ自体は、より長いワークフローの 1 つのノードであることがあり、それにより表示ユーザーは、個々のアクションのセットではなく、そのステージのステータスを全体として見ることができます。
  
    
    
Visio 2013 に組み込まれている SharePoint 2013 ワークフロー テンプレートは、ステージ、ループ、およびステップをワークフローを作成するための論理構成要素としても使用します。 
  
    
    

> **重要**
> Microsoft SharePoint 2010 ワークフロー テンプレートと SharePoint 2013 ワークフロー テンプレートの間の基本的な違いのため、一方で作成された図中のテンプレートの図形を他方で使用することはできません。SharePoint 2013 ワークフロー アクション、SharePoint 2013 ワークフロー条件、および SharePoint 2013 ワークフロー ターミネータのステンシルによる図形のみ、SharePoint 2013 ワークフローを構築するために使用できます。 
  
    
    


### ステージの図形

ステージには、任意の数の図形を含めることができ、分岐を含めることもできます。ただし、1 つのステージ (およびステップ) について、入側のパスが 1 つと出側のパスが 1 つのみです。ワークフロー内のすべてのアクションは 1 つのステージ内に含まれている必要があります。ステージの図形は、コンテナー図形を使用して視覚化されます。ステージ図形では、ステージの入側と出側のパスを定義するため、入口図形と出口図形をコンテナーの端に追加する必要があります。Visio 2013、および SharePoint Designer 2013 のビジュアル デザイナーは、コンテナーが初めてドロップされるときに入口図形と出口図形を追加します。
  
    
    
ステージには次のようなルールもあります。
  
    
    

- すべての図には、少なくとも 1 つのステージが必要です。入口、出口、および開始の各図形をすべて備えた 1 つのステージが、既定の SharePoint 2013 ワークフロー テンプレートの一部として存在します。
    
  
- 新しいステージを描画キャンバスに追加すると、Visio 2013 は、ステージがドロップされるときに開始コネクタと終了コネクタを追加します。
    
  
- ステージには、入口図形と出口図形によるもの以外、入側と出側のコネクタを含めることはできません。
    
  
- ステージ コンテナーをネストすることはできません。ステージ内の別のサブプロセスをネストする場合は、ステップを使用してください。
    
  
- ワークフローの停止図形はステージ内に含めることができます。
    
  
- 図全体では、ステージの外側に 1 つの明示的な開始図形が必要です。ステージの外側に明示的な終了図形は不要です。
    
  
- ワークフローは、最上位レベルにおいて、ステージ、条件付き図形、および開始と終了のターミネータのみを含むことができます。他のすべての図形は、ステージ内に含める必要があります。
    
  

### ループの図形

ループは、ループとして実行される一連の接続された図形で、条件が満たされるまで、その一連の図形の最後の図形から最初の図形に戻ります。 
  
    
    
ステージ同様、ループは (図形が描画キャンバスにドロップされるときに追加される) 入口図形と出口図形を含んだコンテナー図形によって表されます。ループ図形では、入口図形と出口図形をコンテナーの端に追加してループの入側と出側のパスを定義する必要があります。
  
    
    
Visio 2013 および SharePoint Designer 2013 は、 *n*  回のループと *value1*  が *value2*  と等しくなるまでのループの 2 種類のループをサポートします。
  
    
    
ループは次のルールに準拠する必要があります。
  
    
    

- ループはステージ内に存在する必要があり、ステージがループ内に存在することはできません。
    
  
- ステップはループ内に含めることができます。
    
  
- ループには入口と出口点をそれぞれ 1 つだけ含めることができます。
    
  

### ステップの図形

ステップは、グループ化された一連の連続アクションを表します。ステップはステージに含まれる必要があります。ステップ図形には、図形の入側と出側のパスを定義するための入口図形と出口図形も必要です。どちらの図形とも、既定で図形がキャンバスにドロップされるときに追加されます。
  
    
    

## Visio 2013 でのワークフローの作成
<a name="VSSPD_Creating"> </a>

SharePoint 2013 ワークフロー ステンシルにあるすべてのマスター図形は、SharePoint 2013 ワークフロー内のアクション、条件、およびその他の論理コンストラクトに対応しています。ワークフローを構築する場合は、Visio 内のほかのフローチャートの場合と同様に、図形を描画キャンバスにドロップできます。Visio 2013でワークフローの構築を完了した後は、SharePoint Designer 2013で開く前にワークフローを保存します。
  
    
    
Visio 2013 で SharePoint 2013 ワークフロー テンプレートを開くには、以下の手順を実行します。
  
    
    

### Visio 2013 で SharePoint 2013 ワークフロー テンプレートを開くには


1. Visio 2013 を開きます。
    
  
2. [ **新規作成**] を選択します。
    
  
3. [ **テンプレート カテゴリ**] で [ **フローチャート**] を選択します。
    
  
4. [ **テンプレートの選択**] で、[ **SharePoint 2013 ワークフロー**] を選択して、[ **作成**] を選択します。
    
    テンプレートが開き、描画キャンバスに開始およびステージの各図形が取り込まれます。ステージ図形には、1 つのコネクタによって結合された入口図形と出口図形が含まれています。
    
  
SharePoint 2013 ワークフロー テンプレートが開いている状態で、アクション、条件、およびその他の図形を描画キャンバスにドラッグして、ワークフローを設計します。個々の図形とその意味の詳細については、「 [Visio の SharePoint Server ワークフロー テンプレートの図形](shapes-in-the-sharepoint-server-workflow-template-in-visio.md)」を参照してください。
  
    
    

> **ヒント**
>  ワークフローの設計時は、次の追加の考慮事項を念頭においてください。>  ワークフローをすばやく構築するには、新しいステージ図形に含まれている内部コネクタにアクション図形と条件図形をドロップします。Visio 2013 は、そのコネクタを自動的に追加のコネクタに分割し、ワークフローが入口図形から出口図形に接続された状態を維持します。>  SharePoint 2013 ワークフロー アクション、SharePoint 2013 ワークフロー条件、およびSharePoint 2013 ワークフロー ターミネータのステンシル以外のステンシルからの図形は使用しないでください。図形間の接続を追加するには、SharePoint 2013 ワークフロー テンプレートによって提供されるコネクタ ツールのみを使用してください。それ以外のすべてのコネクタ図形は、SharePoint 2013 ワークフロー内では無効です。>  アクションの図形、ステップ、およびループは、常にステージ図形内に含まれている必要があります。一部の条件付き図形はステージの外部に作成できます。>  ステージ図形には、入口図形と出口図形が厳密に 1 つずつ存在する必要があります。ステージ内に含まれているワークフロー サブプロセスは、入口図形で始まり、出口図形で終わる必要があります。>  条件図形には、その図形を起点とする 2 つのコネクタ (ラベルが "はい" のものと "いいえ" のもの) が必要です。コネクタを右クリックすると、[ **はい**] または [ **いいえ**] を選択できます。 >  1 つのワークフローには、開始図形が 1 つだけ必要です。開始図形はステージの外部に作成する必要があります。>  ワークフロー内の図形にテキストを追加しても、図形のテキストはワークフローに影響を及ぼしません。
  
    
    


  
    
    
Visio 2013 でのワークフローの検証は、他のすべての接続された図の検証と同様です。つまり、Visio がルール セットに照らして図をチェックし、図で見つかったエラーの一覧を返します。検証問題の解決方法の詳細については、「 [Visio での SharePoint Server ワークフロー検証エラーのトラブルシューティング](troubleshooting-sharepoint-server-workflow-validation-errors-in-visio.md)」の記事を参照してください。
  
    
    

### Visio 2013 で SharePoint 2013 ワークフローを検証するには


1. [ **プロセス**] タブの [ **図の検証**] グループで、[ **図のチェック**] を選択します。
    
  
2. ワークフローでエラーが検出されると、その図の下に [ **問題**] ウィンドウが開きます。一覧で各項目を選択して、エラーの原因となった図内の図形を選択します。
    
  
3. [ **問題**] の一覧にある各検証エラーを解決します。すべてのエラーへの対応が終了したら、もう一度 [ **図のチェック**] を選択します。Visio 2013 での検証問題の解決方法の詳細については、「 [Visio での SharePoint Server ワークフロー検証エラーのトラブルシューティング](troubleshooting-sharepoint-server-workflow-validation-errors-in-visio.md)」の記事を参照してください。
    
  
4. ワークフローでエラーが検出されないと、図の検証が完了したが問題は何も検出されなかったことを示すメッセージが Visio に表示されます。
    
  
Visio 2013 でのワークフローの検証に合格した後は、ファイルを保存して SharePoint Designer 2013 にインポートすることができます。Microsoft SharePoint 2010 のワークフロー テンプレートとは異なり、SharePoint 2013 ワークフロー図のコピーを既定の Visio 2013 ファイル形式 (.vsdx) で保存し、SharePoint Designer 2013 でそのファイルを開くことができます。 
  
    
    
以下の手順に従って、SharePoint 2013 ワークフローを Visio 2013 に SharePoint Designer 2013 で開くことができる Visio 2013 .vsdx ファイルとして保存します。
  
    
    

### Visio 2013 でワークフローを保存するには


1. [ **ファイル**]、[ **名前を付けて保存**] の順に選択します。
    
  
2. [ **名前を付けて保存**] で [ **保存**]、[ **参照**] の順に選択します。
    
  
3. [ **名前を付けて保存**] ダイアログ ボックスで、ファイルの保存先を選択して、ファイルの名前 ("My SP Workflow") を入力します。
    
  
4. [ **保存**] を選択します。
    
  

## SharePoint Designer 2013 でのワークフローのカスタマイズと発行
<a name="VSSPD_Customizing"> </a>

Visio 2013 で SharePoint 2013 ワークフローの基となるビジネス ロジックを作成して図を保存したら、SharePoint Designer 2013 で Visio .vsdx ファイルを開き、SharePoint 2013 サイトに合わせてそのワークフローを調整することができます。.vsdx ファイル パッケージには、SharePoint Designer 2013 がワークフローに変換可能な XML ドキュメントが含まれています。
  
    
    
以下の手順に従って、SharePoint Designer 2013 で SharePoint 2013 サイトを開きます。
  
    
    

### SharePoint Designer 2013 で SharePoint 2013 サイトを開くには


1. SharePoint Designer 2013 を開きます。
    
  
2. [ **SharePoint サイトを開く**] で [ **サイトを開く**] を選択します。
    
  
3. [ **サイトを開く**] ダイアログ ボックスで、開くサイトを選択します。
    
  
4. [ **開く**] を選択します。
    
  
SharePoint 2013 サイトが開いたら、SharePoint Designer 2013 内で Visio 2013 .vsdx 図を開くことができます。
  
    
    

### SharePoint Designer 2013で Visio Professional 2013 ワークフローを開くには


1. [ **ファイル**] を選択して、[ **項目の追加**] を選択します。
    
  
2. リスト ワークフローを作成するには、以下の手順を実行します。
    
1. [ **ワークフロー**] で、[ **リスト ワークフロー**] を選択します。
    
  
2. 左側のウィンドウの [ **リスト ワークフロー**] で、ワークフローの名前 (My First SP2013 Workflow) を入力し、ワークフローを発行するサイトのリストを選択します。
    
  
3. [ **新しいワークフローのためのワークフローの選択**] の一覧で、[ **SharePoint 2013 ワークフロー**] を選択します。
    
  
4. [ **作成**] を選択します。
    
  
3. サイト ワークフローを作成するには、以下の手順を実行します。
    
1. [ **ワークフロー**] で [ **サイト ワークフロー**] を選択します。
    
  
2. 左側のウィンドウの [ **サイト ワークフロー**] で、ワークフローの名前 (My First SP2013 Workflow) を入力します。
    
  
3. [ **新しいワークフローのためのワークフローの選択**] の一覧で、[ **SharePoint 2013 ワークフロー**] を選択します。
    
  
4. [ **作成**] を選択します。
    
  
4. [ **ワークフロー**] タブの [ **管理**] グループで、[ **ワークフロー設定**] を選択します。
    
  
5. [ **ワークフロー設定**] タブの [ **管理**] グループで、[ **Visio からインポート**] を選択します。
    
  
6. [ **Visio 図面からのワークフローのインポート**] ダイアログ ボックスで, .vsdx ファイルが格納されている場所を参照します。
    
  
7. 開くファイル (My SP Workflow) を選択して、[ **開く**] を選択します。
    
  
SharePoint Designer 2013 で .vsdx ファイルを開くと、そのファイルは、SharePoint Designer 内でホストされる Visio ActiveX コントロールであるビジュアル デザイナーに表示されます。Visio 2013 の図は、Visio で作成された図形と図形テキストのすべてを保持しています。 
  
    
    

> **メモ**
> SharePoint Designer 2013でビジュアル デザイナーと宣言デザイナーを切り替えるには、[ **ワークフロー**] タブの [ **管理**] グループで、[ **ビュー**] を選択します。SharePoint Designer 2013によってワークフローが検証され、ワークフロー情報の形式が別の形式に変換されるので、この処理には少し時間がかかります。この処理の間に、別の図形レベルの検証が行われます。図でエラーが検出された場合は、(Visio の場合と同様に) キャンバス最下部のエラー ウィンドウにエラーが表示されます。 
  
    
    

ビジュアル デザイナーに表示される図形には、操作タグもあります (図形の左下にあるワークフローの設定タイプのアイコンによって示されます)。操作タグを選択すると、ドロップダウン メニューに、ワークフローにおけるそのアクションまたは条件の属性と [ **プロパティ**] プロパティが表示されます。これらのプロパティにより、そのアクションで使用されるパラメーター値 (項目の抽出元のリスト、使用する計算演算子、またはメッセージの送信先の電子メール アドレス) が定義されます。リストに表示されているプロパティを選択すると、そのプロパティの設定をカスタマイズできるダイアログ ボックスが表示されます。 
  
    
    
たとえば、[ **電子メールを送信する**] 図形には、[ **電子メールを作成する**] と [ **プロパティ**] の 2 つのプロパティが関連付けられています。[ **電子メールを作成する**] を選択すると [ **電子メール メッセージを定義する**] ダイアログ ボックスが表示されるので、アクションによって送信されるメッセージをそのダイアログ ボックスで作成できます。[ **プロパティ**] を選択すると、[ **電子メールのプロパティを送信する**] ダイアログ ボックスが開き、アクションのパラメーターすべてが表示されます。
  
    
    

> **メモ**
> 個々のアクション、図形、およびそのプロパティの詳細については、「 [Visio の SharePoint Server ワークフロー テンプレートの図形](shapes-in-the-sharepoint-server-workflow-template-in-visio.md)」および「 [ワークフロー アクション クイック リファレンス (SharePoint 2013 ワークフロー プラットフォーム)](workflow-actions-quick-reference-sharepoint-2013-workflow-platform.md)」の記事を参照してください。 
  
    
    

ワークフロー内でプロパティを設定し、発行する準備ができたら、まず SharePoint Designer 2013 でワークフローにエラーがないことをチェックする必要があります。リボンの [ **ビジュアル デザイナー**] タブで [ **発行**] を選択すると、SharePoint Designer 2013 は自動的にワークフローにエラーがないかどうかチェックします。必要に応じ、手動でエラー チェックを開始することもできます。
  
    
    
次の手順に従って、SharePoint Designer 2013 で SharePoint 2013 ワークフローをチェックします。
  
    
    

### SharePoint Designer 2013 でワークフローにエラーがあるかどうかを手動でチェックするには


1. [ **ビジュアル デザイナー**] タブの [ **保存**] グループで、[ **エラーの確認**] を選択します。
    
  
2. ワークフローでエラーが検出されると、ビジュアル デザイナーのキャンバスの下に [ **問題**] ウィンドウが開きます。一覧で各項目を選択し、エラーの原因となったワークフローのアクション、条件、コネクタ、ターミネータ、またはコンテナーを選択します。
    
  
3. [ **問題**] の一覧にある各検証エラーを解決します。すべてのエラーへの対応が終了したら、もう一度 [ **エラーの確認**] を選択します。 
    
  
4. ワークフローでエラーが検出されると、SharePoint Designer に、ワークフローで何も問題が見つからなかったことを示すメッセージが表示されます。
    
  
ワークフローのチェックが済み、問題が見つからなかった場合は、ワークフローを SharePoint リストに発行できます。SharePoint Designer 2013 からワークフローを発行するには、[ **ビジュアル デザイナー**] タブの [ **保存**] グループで、[ **発行**] を選択します。発行プロセス中にエラーが発生すると、SharePoint Designer 2013 がビジュアル デザイナーに戻り、[ **問題**] ウィンドウにエラーが表示されます。
  
    
    

## その他の技術情報
<a name="VSSPD_Additional"> </a>

詳細については、次のリソースを参照してください。
  
    
    

-  [ワークフロー アクション クイック リファレンス (SharePoint 2013 ワークフロー プラットフォーム)](workflow-actions-quick-reference-sharepoint-2013-workflow-platform.md)
    
  
-  [Visio の SharePoint Server ワークフロー テンプレートの図形](shapes-in-the-sharepoint-server-workflow-template-in-visio.md)
    
  
-  [Visio での SharePoint Server ワークフロー検証エラーのトラブルシューティング](troubleshooting-sharepoint-server-workflow-validation-errors-in-visio.md)
    
  
-  [Visio 2010 で SharePoint ワークフローを作成、インポート、およびエクスポートする](http://office.microsoft.com/ja-jp/ha101888007.aspx)
    
  
-  [SharePoint デベロッパー センター](http://msdn.microsoft.com/ja-jp/sharepoint/default.aspx)
    
  
-  [Visio デベロッパー センター](http://msdn.microsoft.com/ja-jp/office/aa905478)
    
  

